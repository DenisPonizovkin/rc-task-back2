# Задача на должность middle-программист

## Описание данных

Даны стоимости проектов и подпроектов в млрд р, которые меняются по годам.
Данные иерархические, то есть обладают структурой дерева, где иерархия показана
в колонке код. Терминальные узлы дерева хранят значения.
При этом каждые данные маркируются версией.

## Описание задачи

Необходимо реализовать микро-сервис при помощи fast api с 2 маршрутами:

1. Загрузка файлов, примеры которых есть в репо.
При этом при загрузке файла данные должны класться в БД PostgreSQL.
Поэтому необходимо предоставить DDL файл с моделью данных, котоаря представляет из себя древовидную структуру.
При загрузке файла данные должны записываться с инкрементом версии данных.

2. Выгрузка данных из БД в структуре входных файлов. При этом для нетерминальных узлов необходимо
провести расчет - сделать агрегат по дочерним узлам с суммой. Параметр запроса - версия данных.

Работа с данными должна производиться без применения ORM, с помощью SQL-запросов и библиотеки pandas.